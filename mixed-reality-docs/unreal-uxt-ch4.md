---
title: 4. シーンを対話型にする
description: Unreal Engine 4 と Mixed Reality ツールキット UX ツール プラグインを使用して簡単なチェス アプリを構築するためのチュートリアル シリーズのパート 6 の 4
author: hferrone
ms.author: v-haferr
ms.date: 5/5/2020
ms.topic: article
ms.localizationpriority: high
keywords: Unreal, Unreal Engine 4, UE4, HoloLens, HoloLens 2, Mixed Reality, チュートリアル, 入門, mrtk, uxt, UX ツール, ドキュメント
ms.openlocfilehash: a9de5755ab86c96322a8d50fecd7ba2cdea866d3
ms.sourcegitcommit: 1b8090ba6aed9ff128e4f32d40c96fac2e6a220b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/03/2020
ms.locfileid: "84330219"
---
# <a name="4-making-your-scene-interactive"></a>4.シーンを対話型にする

## <a name="overview"></a>概要

前のチュートリアルでは、ARSession、ポーン、およびゲーム モードを追加して、チェス アプリの Mixed Reality セットアップを完了しました。 このセクションでは、オープン ソースの [Mixed Reality Toolkit UX Tools](https://github.com/microsoft/MixedReality-UXTools-Unreal) プラグインの使用方法について説明します。このプラグインには、シーンを対話型にするためのツールが用意されています。 このセクションが完了するまでに、ユーザー入力でチェスの駒を移動できるようになります。 

## <a name="objectives"></a>目標

* Mixed Reality Toolkit UX Tools プラグインをダウンロードする 
* ハンド インタラクション アクターを指先に追加する
* シーン内のオブジェクトにマニピュレーターを作成して追加する
* 入力シミュレーションを使用してプロジェクトを検証する

## <a name="downloading-the-mrtk-ux-tools-plugin"></a>MRTK UX Tools プラグインのダウンロード
ユーザー入力の操作を開始する前に、プラグインをプロジェクトに追加する必要があります。

1.  [GitHub リポジトリ](https://github.com/microsoft/MixedReality-UXTools-Unreal/releases)から最新の MRTK UX Tools プラグインをクローンまたはダウンロードし、ファイルを解凍します。

2.  プロジェクトのルート フォルダーに、**Plugins** という名前の新しいフォルダーを作成します。 解凍された UXTools プラグインをこのフォルダーにコピーし、Unreal エディターを再起動します。 

![プロジェクト プラグイン フォルダーを作成する](images/unreal-uxt/4-plugins.PNG)

3.  UXTools プラグインには、**ポインター**、**入力シミュレーション**、および**単純なボタン**のサブフォルダーのある Content フォルダーと、関数別の C++ Classes フォルダーがあります。  

> [!NOTE]
> **コンテンツ ブラウザー**に **[UXTools コンテンツ]** セクションが表示されない場合は、 **[表示オプション] > [プラグイン コンテンツを表示する]** をクリックします。 

![プラグイン コンテンツを表示する](images/unreal-uxt/4-showplugincontent.PNG)

プラグインが安全にインストールされたら、ハンド インタラクション アクターから始めて、プラグインが提供する必要のあるツールを使用することができます。

## <a name="spawning-hand-interaction-actors"></a>ハンド インタラクション アクターを生成する
UX 要素とのハンド インタラクションは、ハンド インタラクション アクターを使用して実行されます。これにより、近接および遠隔のインタラクションのポインターとビジュアルが作成および起動されます。
- *近接インタラクション*は、人差し指と親指で要素をつまむか、指先でそれらをつつくことによって実行されます。 
- *遠隔インタラクション* は、仮想ハンドの光線を要素にあてて、人差し指と親指を一緒に押すことで実行されます。

この例では、**MRPawn** にハンド インタラクション アクターを追加すると、次の処理が行われます。
- ポーンの人差し指の先端にカーソルを追加します。
- ポーンを介して操作できる多関節ハンド入力イベントを提供します。
- 仮想ハンドの手のひらから伸びる手の光線を通して、遠くの相互作用入力イベントを許可します。

これらの概念を理解するために、操作を続行する前に、ハンド インタラクションに関する[ドキュメント](https://github.com/microsoft/MixedReality-UXTools-Unreal/blob/public/0.8.x/Docs/HandInteraction.md)を参照することをお勧めします。 

準備ができたら、**MRPawn** ブループリントを開き、 **[Event Graph]\(イベント グラフ\)** に移動します。 

1. **Event BeginPlay** から実行ピンをドラッグ アンド リリースして、新しいノードを配置します。 
    * **[Spawn Actor from Class]** を選択し、 **[クラス]** ピンの横にあるドロップダウンをクリックし、**Uxt ハンド インタラクション アクター**を検索します。 

2. **SpawnActor Uxt Hand Interaction** ノードから実行ピンをドラッグ アンド リリースし、**Uxt Hand Interaction Actor** クラスの **Set Hand** 関数を検索します。 
    * **SpawnActor** ノードの**戻り値**を **Set Hand** ノードの **[ターゲット]** ピンに接続します。 これにより、ハンド インタラクション アクターの手が**左**に設定されます。 

3. 2 番目の **Uxt ハンド インタラクション アクター**を生成します。今回は、手を**右**に設定します。 イベントが開始されると、Uxt ハンド インタラクション アクターがそれぞれの手で生成されます。 

**イベント グラフ**は、次のスクリーンショットと一致している必要があります。

![Uxt ハンド インタラクション アクターを生成する](images/unreal-uxt/4-spawnactor.PNG)

Uxt ハンド インタラクション アクターには、オーナーと最初の変換場所が必要です。 ハンド インタラクション アクターが表示されるとすぐに仮想ハンドにジャンプするため、最初の変換は重要ではありません (この動作は UX Tools プラグインに含まれています)。 ただし、`SpawnActor` 機能では、コンパイラ エラーを回避するために変換入力が必要であるため、既定値を使用します。 

1. **Spawn Transform** ピンの 1 つからピンをドラッグ アンド リリースして、新しいノードを配置します。 
    * **Make Transform** ノードを検索し、**戻り値**をもう一方の **Spawn Transform** にドラッグして、両方の **SpawnActor** ノードが接続されるようにします。 

3.  両方の **SpawnActor** ノードの下部にある**下矢印**をクリックして、 **[所有者]** ピンを表示します。    
    * **[所有者]** ピンの 1 つからピンをドラッグ アンド リリースして、新しいノードを配置します。 
    * **self** を検索して **Get a reference to self** 変数を選択し、**Self**  オブジェクト参照ノードと他のハンド インタラクション アクターの **[所有者]** ピンの間にリンクを作成します。 
    * **コンパイル**と**保存**を行って、メイン ウィンドウに戻ります。 

接続が次のスクリーンショットと一致していることを確認しますが、ブループリントを読みやすくするためにノードをドラッグしてもかまいません。

![Uxt ハンド インタラクション アクターのセットアップを完了する](images/unreal-uxt/4-fingerptrs.PNG) 

MRTK UX Tools プラグインに用意されているハンド インタラクション アクターの詳細については、[ドキュメント](https://microsoft.github.io/MixedReality-UXTools-Unreal/version/public/0.8.x/Docs/HandInteraction.html)を参照してください。

これで、プロジェクトの仮想ハンドはオブジェクトを選択できるようになりましたが、オブジェクトを操作することはできません。 アプリをテストする前の最後のタスクは、シーン内のアクターにマニピュレーター コンポーネントを追加することです。

## <a name="attaching-manipulators"></a>マニピュレーターの添付

マニピュレーターは、多関節ハンドによる入力に応答するコンポーネントであり、つかんだり、回転させたり、および変換したりできます。 マニピュレーターの変換をアクターの変換に適用すると、アクターの直接操作が可能になります。 

1. **[ボード]** ブループリントを開き、 **[コンポーネントの追加]** をクリックして、 **[コンポーネント]** パネルで **Uxt 汎用マニピュレーター**を検索します。

![汎用マニピュレーターを追加する](images/unreal-uxt/4-addmanip.PNG)

2. **[詳細]** パネルの **[汎用マニピュレーター]** セクションを展開します。 ここから片手または両手操作、回転モード、スムージングを設定できます。 好きなモードを自由に選択して、ボードを**コンパイル**し、**保存**します。 

![モードを設定する](images/unreal-uxt/4-setrotmode.PNG)

3. **WhiteKing** アクターについて上記の手順を繰り返します。

MRTK UX Tools プラグインに用意されているマニピュレーター コンポーネントの詳細については、[ドキュメント](https://microsoft.github.io/MixedReality-UXTools-Unreal/version/public/0.8.x/Docs/Manipulator.html)を参照してください。

## <a name="testing-the-scene"></a>シーンのテスト
良い知らせです。 これで、新しい仮想ハンドとユーザー入力でアプリをテストする準備が整いました。 メイン ウィンドウで **[再生]** を押すと、MRTK UX Tools プラグインから 2 つのメッシュ ハンドが提供され、それぞれの手の平からハンド レイが伸びているのを確認できます。 次のように、手とその相互作用を制御できます。
- **左 Alt** キーを押しながら**左手**を制御し、**左 Shift** キーを押して**右手**を制御します。 
- マウスを動かして手を動かし、**マウス ホイール**を使用してスクロールして、手を**前方**または**後方**に移動します。 
- 左マウスをクリックして**ピンチ**、マウスの中央ボタンをクリックして**指さし**を行います。 

![ビューポート内のシミュレートされた手](images/unreal-uxt/4-handsim.PNG)

シミュレートされた手を使用して、チェスの白キングを手に取り、移動して、置いて、ボードを操作してみましょう。 近接インタラクションと遠隔インタラクションの両方を試してみてください。手がボードとキングを直接つかめる位置まで近づくと、ハンド レイが消え、人差し指の先が指カーソルに置き換わります。 

MRTK UX Tools プラグインに用意されているシミュレートされた手の機能の詳細については、[ドキュメント](https://microsoft.github.io/MixedReality-UXTools-Unreal/version/public/0.8.x/Docs/InputSimulation.html)を参照してください。

これで、仮想ユーザーがオブジェクトと対話できるようになったので、次のチュートリアルに進み、ユーザー インターフェイスとイベントを追加する準備ができました。

[次のセクション: 5.ボタンの追加およびピースの位置のリセット](unreal-uxt-ch5.md)
