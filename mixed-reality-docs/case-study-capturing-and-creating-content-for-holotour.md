---
title: ケーススタディ-HoloTour
description: Microsoft HoloLens の HoloTour は、世界中のアイコンの位置をイマーシブ3D で表示します。 このケーススタディでは、HoloTour に使用するコンテンツをキャプチャして作成するプロセスについて説明します。
author: dannyaskew
ms.author: daaske
ms.date: 03/21/2018
ms.topic: article
keywords: HoloTour、HoloLens、Windows Mixed Reality
ms.openlocfilehash: 59c3dffd48009aa792643ea27b59f8f6f85b64d7
ms.sourcegitcommit: d6ac8f1f545fe20cf1e36b83c0e7998b82fd02f8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81278190"
---
# <a name="case-study---holotour"></a>ケーススタディ-HoloTour

Microsoft HoloLens の HoloTour は、世界中のアイコンの位置をイマーシブ3D で表示します。 このプロジェクトに携わっているデザイナー、アーティスト、プロデューサー、オーディオデザイナー、および開発者が発見したので、既知の場所の convincingly リアル3D レンダリングを作成するには、creative と技術的な wizardry を独自に組み合わせて使用します。 このケーススタディでは、HoloTour に使用するコンテンツをキャプチャして作成するプロセスについて説明します。

## <a name="the-tech"></a>技術

HoloTour を使用して、ユーザーが自分の生きた部屋から直接、ペルーの[Machu の廃墟](https://en.wikipedia.org/wiki/Machu_Picchu)や、イタリアの現代の日[Piazza Navona](https://en.wikipedia.org/wiki/Piazza_Navona)など、世界の最も優れた宛先のいくつかにアクセスできるようにしたいと考えました。 私たちのチームは、"本当に HoloTour" という目標を達成しました。 このエクスペリエンスは、単なる画像またはビデオである必要があります。 HoloLens の固有の表示、追跡、およびオーディオテクノロジを利用することで、他の場所に仮想的に転送できると信じています。 ここでは、アクセスしたすべての場所の視点、サウンド、3次元のジオメトリをキャプチャし、アプリ内で再作成する必要があります。

これを行うには、指向性オーディオキャプチャを使用して360°カメラのリモートテストを行う必要があります。 これは非常に高い解像度でキャプチャする必要があるため、HoloLens で再生したときに撮影した映像が鮮明に見えるようにするためには、アイテムの合成を最小限にするためにカメラを近くに配置する必要があります。 水平方向だけでなく、さらに上と下にも球の全範囲が必要でした。 また、マシン群は、世界中でも使用できるように移植可能である必要があります。 利用可能な既製のオプションを評価し、解決、コスト、またはサイズのいずれかによって、ビジョンを実現するのに十分ではなかったことを実感しています。 ニーズを満たすカメラのテストマシンが見つからなかった場合は、自分で作成する必要があります。

### <a name="building-the-rig"></a>テストマシン群の構築

最初のバージョンは、厚紙、Velcro、ダクトテープ、14 GoPro カメラから作成されたものであり、マクガイバーが誇りを持っていました。 GoPro カメラは、低価格で手頃な価格で、使いやすいメモリストレージを備えていたため、エンドツーエンドソリューションからカスタムのテスト対象マシンに至るまで、すべてを確認した結果、最終的に最適な選択肢となりました。 小さなフォームファクターが特に重要なのは、カメラを近くに配置することが許可されているためです。カメラ間の距離が小さいほど、合成するアイテムのサイズが小さくなります。 独自のカメラの調整により、球体の完全*なカバレッジを*取得して、カメラをインテリジェントに調整し、合成プロセス中に一部のアーティファクトをスムーズにすることができました。

HoloLens で[空間サウンド](spatial-sound.md)機能を利用することは、convincingly の実際のイマーシブエクスペリエンスを作成するうえで重要です。 三脚のカメラの下にある4つのマイクの配列を使用しました。これにより、カメラの位置から4つの方向にサウンドがキャプチャされます。これにより、バックグラウンドで空間サウンドを作成するための十分な情報が得られます。

![360°カメラのリモートテストマシン群は Pantheon 以外の撮影に設定されています。](images/camera-pantheon-200px.png)

360°カメラのリモートテストマシン群は Pantheon 以外の撮影に設定されています。 


私たちは、シアトル近くのたねじ山を使って、手作りのリモートテストマシンをテストし、ハイキングの上部にシーナリーをキャプチャしています。 この結果は、今日の HoloTour に見た場所よりも大幅に洗練されていますが、これまでのように、テストマシンの設計が十分であるという自信を持っています。

Velcro と厚紙から3D 印刷カメラハウジングにアップグレードし、GoPro カメラ用の外部バッテリパックを購入して、バッテリ管理を簡略化しました。 さらに広範なテストを行いました。サンフランシスコに移動し、市の海岸とアイコンのゴールデンゲートブリッジの小さなツアーを作成しました。 このカメラのマシン群は、HoloTour でアクセスする場所のほとんどのキャプチャに使用されています。

![Machu の撮影には、360°カメラのリモートテストマシン群があります。](images/camera-machu-pichu-500px.png)

Machu の撮影には、360°カメラのリモートテストマシン群があります。 

## <a name="behind-the-scenes"></a>しくみ

撮影する前に、仮想ツアーに含める場所を確認する必要がありました。 ローマは最初に発送した場所であり、適切に取得したいので、scouting 旅行を事前に決定しました。 私たちは、お客様が検討したサイトにアクセスするために、アーティスト、デザイナー、プロデューサーなどの6人のユーザーのチームを送信しました。 旅行のためには、撮影のために約9日 ~ 2.5 がかかりました。 (Machu の撮影については、斥候旅行を行うことを選択していません。事前に調査し、のために数日間のバッファーを予約しています)。

ローマでは、チームは各領域の写真を撮影し、興味深い事実を示しています。また、crowds または制限のために各場所に移動するのが困難であり、フィルムにどのくらい難しいかなど、実用的な考慮事項もありました。 これは休暇と同じように聞こえますが、大量の作業になります。 何日も早く開始され、夜間までは停止しません。 夜間には、チームがチームをレビューするためにフッテージがアップロードされました。 

![ローマでのキャプチャクルー。](images/holotour-filming-crew-rome-500px.jpg) 

ローマでのキャプチャクルー。 


斥候旅行が完了した後、実際の撮影に対して最後のプランが作成されました。 これには、フィルムに移動する場所、日、および時刻の詳細な一覧が必要でした。 海外の日々の費用がかかります。そのため、このような旅行は効率的である必要があります。 ローマでガイドとハンドラを予約しました。このガイドとハンドラーは、日没の前から朝までのすべての日に完全に使用できます。 実際に使用するのと同じように、最適なフッテージを取得する必要があります。

### <a name="capturing-the-video"></a>ビデオをキャプチャする

キャプチャ中にいくつかの簡単な操作を行うと、後処理がより簡単になります。 たとえば、複数のカメラからイメージをまとめて合成する場合、各カメラのビューが若干異なるため、ビジュアルアイテムが表示されます。 オブジェクトがカメラに近いほど、ビュー間の差が大きくなり、合成するアイテムが大きくなります。 問題を視覚化する簡単な方法を次に示します。表面の前につまみを置き、目を1つだけ見てみましょう。 次に、視点を切り替えます。 背景に対して基準が移動するように見えます。 表面から離れた場所につまみを置いて実験を繰り返すと、つまみが小さくなるように見えます。 このように見える動きは、カメラのように見ても、まったく同じイメージが表示されないので、少し離れたところに見えないということです。

処理後の成果物を修正するよりも、最悪のアーティファクトを撮影するよりもはるかに簡単なので、彼らはカメラから遠く離れた場所にいることを望んでいるので、クローズアップオブジェクトを合成する必要がなくなりました。 カメラの周りの大きな消去を維持することは、多くの場合、撮影中に発生した最大の課題の1つであり、それを実現するためにクリエイティブな作業を行う必要がありました。 ローカルガイドを使用することは、crowds の管理において大きな助けとなりました。ただし、特に、各場所で少しずつフッテージを取得する必要があるため、撮影空間が適度に有効であることをマークするために、記号 (小さいコーンや bean バッグ) を使用することもありました。 多くの場合、適切なキャプチャを実現する最善の方法は、ほとんどの従業員が登場する前に、朝の早い段階で到着することでした。

他の便利なキャプチャ手法の中には、従来のフィルムプラクティスから直接アクセスできるものがあります。 たとえば、後で必要になる可能性があるテクスチャとオブジェクトのすべてのカメラとキャプチャされた参照写真に色補正カードを使用しています。 

![カラー修正カードを示す Machu のラフカットの荒削り。](images/rough-cut-machu-picchu-500px.png)

結合前の Pantheon フッテージのラフカット。

### <a name="processing-the-video"></a>ビデオの処理

360°のコンテンツのキャプチャは最初の手順にすぎません。 HoloTour に表示される最終的なアセットにキャプチャした未加工のカメラのフッテージを変換するために、大量の処理が必要になります。 自宅に戻った後は、14の異なるカメラフィードからビデオを撮影し、最小成果物を持つ1つの連続ビデオに変換する必要がありました。 私たちの芸術チームは、キャプチャした映像を組み合わせるために多くのツールを使用し、可能な限り処理を最適化するためのパイプラインを作成しました。 映像をまとめて合成、色を修正し、合成して、不要な要素や成果物を削除したり、寿命と動きの補助ポケットを追加したりする必要がありました。

![結合前の Pantheon フッテージのラフカット。](images/rough-cut-pantheon-500px.png)

結合前の Pantheon フッテージのラフカット。 


ビデオをまとめるために、 [Ptgui](https://www.ptgui.com/)というツールを使用して、処理パイプラインに統合しました。 後処理の一環として、引き続きビデオからフレームを抽出し、それらのフレームに適した合成パターンを見つけました。 次に、このパターンをカスタムプラグインに適用しました。これにより、ビデオアーティストは、After 効果で合成しながら、合成パターンを適切に調整し、調整することができました。 

![合成 Pantheon フッテージを示す PTGui のスクリーンショット。](images/stitching-tool-pantheon-500px.png)

合成 Pantheon フッテージを示す PTGui のスクリーンショット。 


### <a name="video-playback"></a>ビデオ再生

映像の処理が完了すると、シームレスなビデオが作成されますが、非常に大きいのは8K の解像度です。 ビデオのデコードはコストがかかり、8K ビデオを処理できるコンピューターはほとんどありません。そのため、次の課題は、このビデオを HoloLens で再生する方法を見つけることができました。 私たちは、ユーザーがビデオ全体を見ているように感じながら、デコードコストを回避するためのさまざまな戦略を策定しました。

最も簡単な最適化は、あまり変更されないビデオの一部をデコードしないようにすることです。 私たちは、ほとんど、またはまったく動作しない各シーンの領域を識別するツールを作成しました。 これらの領域については、各フレームにビデオをデコードするのではなく、静的な画像を示しています。 これを可能にするために、大規模なビデオをかなり小さなチャンクに分割しています。

また、デコードしたすべてのピクセルが最も効果的に使用されていることも確認しました。 ビデオのサイズを小さくするための圧縮技法を実験しています。投影されるジオメトリのポリゴンに応じて、ビデオ領域を分割します。どの程度の詳細な多角形が含まれているかに基づいて、UVs を調整し、ビデオを再パックしています。 この作業の結果として、1つの8k ビデオが、シーンに適切に再プロジェクションされるまで、ほぼ判読できないような多くのチャンクに変換されています。 テクスチャマッピングと UV パッキングを理解しているゲーム開発者にとっては、これはよく知られているでしょう。 

![最適化前の Pantheon の完全なビュー。](images/pantheon-before-optimization-500px.png) 

最適化前の Pantheon の完全なビュー。 


![Pantheon の右半分。ビデオ再生用に処理されます。](images/pantheon-process-video-playback-500px.png) 

Pantheon の右半分。ビデオ再生用に処理されます。 


![最適化とパッキングの後の1つのビデオ領域の例。](images/single-video-region-after-optimization-500px.png) 

最適化とパッキングの後の1つのビデオ領域の例。 


実際に表示されていないビデオのデコードを避けるために、もう1つのトリックを使用しました。 HoloTour では、特定の時点では全シーンの一部しか表示できません。 ビューのフィールド (視界) の内側または外側にあるビデオのみをデコードします。 ヘッドを回転させると、現在見ているビデオの領域の再生が開始され、そこに含まれていない再生が停止します。 ほとんどのユーザーはこれが起こっていることに気付かれませんが、すぐに撮影すると、ビデオの開始に1秒ほどかかります。静止画像が表示され、準備ができたらビデオに戻ります。

この戦略を実現するために、広範なビデオ再生システムを開発しました。 低レベルの再生コードを最適化して、ビデオの切り替えを非常に効率的にしています。 また、動画をいつでもすばやく切り替えることができるように、ビデオを特殊な方法でエンコードする必要がありました。 この再生パイプラインにはかなりの時間がかかり、段階的に実装しました。 私たちは、効率的ではなく、シンプルなシステムを開始しましたが、デザイナーやアーティストは経験を持っています。また、最終的な品質基準バーに出荷することを許可された、より堅牢な再生システムに徐々に改善されています。 この最終的なシステムには、Unity 内に作成したカスタムツールがあり、シーン内でビデオを設定し、再生エンジンを監視していました。

### <a name="recreating-near-space-objects-in-3d"></a>3D でのほぼスペースオブジェクトの再作成

ビデオでは、HoloTour に表示されるほとんどのものを構成していますが、Piazza Navona での塗装、Pantheon の外側のふんすい、航空写真の背景に使用しているホットエアバルーンなど、いくつかの3D オブジェクトが近くに表示されます。 これらの3D オブジェクトは、人間の深さの知覚が非常に優れているため、非常に便利ではないため、重要です。 距離に関するビデオを見ることができますが、ユーザーが自分のスペースをよく見てみたいと思います。近くのオブジェクトには深さが必要です。 この手法は、自然歴史博物館で見られるようなものに似ています。つまり、前景に物理的な造園、植物、および動物 specimens を持つ diorama を描きますが、バックグラウンドでの巧妙マスクされたマットの描画に recedes ます。

オブジェクトによっては、単純に作成されてシーンに追加された3D アセットで、エクスペリエンスが向上します。 描画とホットエアバルーンは、客席したときに存在していなかったため、このカテゴリに分類されます。 ゲームアセットと同様に、チームの3D アーティストによって作成され、適切にテクスチャが作成されました。 これらは、お客様の場所に近い場所に配置され、ゲームエンジンはそれらを2つの HoloLens ディスプレイにレンダリングして、3D オブジェクトとして表示できるようにします。

Pantheon 以外の他の資産は、ビデオを撮影している場所に存在する実際のオブジェクトですが、これらのオブジェクトをビデオから読み込んで3D にするためには、いくつかの作業を行う必要があります。

まず、各オブジェクトに関する追加情報が必要です。 撮影の場所では、これらのオブジェクトの参照フッテージが多数キャプチャされているため、テクスチャを正確に再作成するための十分な詳細なイメージが得られます。 また、チームは[photogrammetry](https://en.wikipedia.org/wiki/Photogrammetry) scan を実行しました。これにより、多数の2d イメージから3d モデルが構築され、完全なスケールでオブジェクトの粗いモデルが提供されます。

フッテージを処理すると、後で3D 表現に置き換えられるオブジェクトがビデオから削除されます。 3D アセットは photogrammetry モデルに基づいていますが、アーティストによってクリーンアップおよび簡素化されています。 一部のオブジェクトについては、ふんすいの水のテクスチャなど、ビデオの一部を使用できますが、ほとんどのふんすいは3D オブジェクトになっています。これにより、ユーザーは深度を認識して、エクスペリエンスの限られた領域でその周囲を調べることができます。 このようなほぼスペースのオブジェクトを使用すると、リアリティの意味が大きくなり、仮想の場所でユーザーを接地させることができます。 

![ふんすいが削除された pantheon フッテージ。 3D アセットに置き換えられます。](images/object-removal-pantheon-500px.png)

ふんすいが削除された pantheon フッテージ。 3D アセットに置き換えられます。


## <a name="final-thoughts"></a>最終的な考え

ここで説明した内容よりも、このコンテンツを作成することは当然です。 いくつかのシーンがあります。これを "不可能なパースペクティブ" と呼びます。これには、Colosseum でのホットエアバルーンの乗り物や gladiator の戦いなどが含まれます。これにより、独創的なアプローチが採用されました。 これらの問題については、今後のケーススタディで説明します。

実稼働中に発生したより大きな課題にソリューションを共有することは、他の開発者にとって役に立ちます。また、これらの手法のいくつかを使用して、HoloLens 向けに独自のイマーシブエクスペリエンスを作成することをお勧めします。 (その場合は、 [HoloLens アプリ開発フォーラム](https://forums.hololens.com/)でお客様と共有するようにしてください)。

## <a name="about-the-authors"></a>作成者について

<table style="border:0">
<tr>
<td style="border:0" width="60px"> <img alt="David Haley" width="60" height="60" src="images/haley.png" /></td>
<td style="border:0" width="408"> <b>David Haley</b>は、HoloTour での作業によって可能であると考えられるカメラのマシンとビデオの再生について詳しく学習したシニア開発者です。</td>
<td style="border:0" width="60px"> <img alt="Danny Askew" width="60" height="60" src="images/askew.png" /></td>
<td style="border:0" width="408"> <b>Danny Askew</b>は、ローマの旅をできるだけ完璧にしたビデオアーティストです。</td>
</tr>
<tr>
<td style="border:0" width="60px"> <img alt="Jason Syltebo" width="60" height="60" src="images/syltebo.png" /></td>
<td style="border:0" width="408"> <b>Jason Syltebo</b>は、時間が戻った場合でも、アクセスするすべての宛先の soundscape を体験できるようにするオーディオデザイナーです。</td>
<td style="border:0" width="60px"> <img alt="Travis Steiner" width="60" height="60" src="images/steiner.png" /></td>
<td style="border:0" width="408"> <b>Travis Steiner</b>は、scouted の場所を研究し、旅行計画を作成し、サイトの有向撮影を作成する設計責任者です。</td>
</tr>
</table>



## <a name="see-also"></a>参照
* [ビデオ: Microsoft HoloLens: HoloTour](https://www.youtube.com/watch?v=pLd9WPlaMpY)
